<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html>
<head>
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function () {
      navigator.serviceWorker.register('/navettasogei/service-worker.js')
        .then(function (registration) {
          console.log('Service Worker registrato con scope:', registration.scope);
        }, function (err) {
          console.log('Registrazione fallita:', err);
        });
    });
  }
</script>
<link rel="manifest" href="manifest.webmanifest">
<meta charset='UTF-8'/>
<meta content='width=device-width, initial-scale=1' name='viewport'/>
<title>Calcolo orario di lavoro normalisti e navette</title>
</head>

<body>
<img src="data:image/png;base64,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" align="right"
       onclick="alert('Navetta Sogei ver. 1.1 (12.06.2025)\n\nCalcola l\'orario di uscita del personale\nnormalista Sogei, mostra gli orari navette\nin uscita calcolando la minor\/maggior presenza\n\nSviluppato da niklocastro\@gmail.com\nContributi di ruggeroa1000@gmail.com');"/>
<br/><br/>
<label for="appt">Ingresso ore </label>
<input type="time" id="appt" name="appt" min="08:00" max="09:45" onchange="calcola()"><br/>
<br/>
<p id="exit">&nbsp;</p>
<br/>
<label for="nav">Navette per </label>
<select id="nav" name="nav" onchange="calcola()">
     <option>Magliana</option>
     <option>Anagnina</option>
     <option>Santa Palomba</option></select><br/>
<div id="navt"></div>
<script><!-- //
function calcola() {
	/*
    var mag=[ [16,15],[16,50],[17,20],[17,50],[18,20] ];
    var ana=[ [16,15],[17,05],[18,15] ];
    */
    var mag=[ [16,15],[16,55],[17,35] ]; //Magliana
    var ana=[ [16,15] ]; //Anagnina
    var pal=[ [16,15] ]; //Santa Palomba
    var time=document.getElementById("appt").value;
    if(time == null || time == "" || time.length != 5 || time.indexOf(':') <= 0) {
	    alert("Impostare orario di ingresso");
        return;
    }
    time=time.split(':');
    if(Number(time[0])<8 || Number(time[0]+time[1])>945 ){
    	alert("Orario ingresso previsto tra le 8 e le 9.45");
     }
     var friday=(new Date().getDay()==5);
     var hh=(friday?7:8)+Number(time[0]);
     var mm=(friday?50:10)+Number(time[1]);
     if(mm>=60) { hh++; mm-=60; }
     if(hh>=24) { hh-=24; }
     document.getElementById("exit").innerHTML
         =('Uscita dopo '+(friday?'7:50':'8:10')+' alle <b>'+hh+':'+(mm<10?'0':'')+mm+'</b>');
     var outmsg="<ul>";
     var nav=mag;
     if(document.getElementById('nav').selectedIndex==1)
        nav=ana;
     if(document.getElementById('nav').selectedIndex==2)
        nav=pal;
     for(var i=0; i < nav.length ; i++) {
     	var hh1=nav[i][0] ;
        var mm1=nav[i][1];
     	if(friday) {
     	    mm1-=20;
            if(mm1<0) { mm1+=60; hh1--; }             
     	}
        outmsg+=("<li><b>"+hh1+":"+(mm1<10?'0':'')+mm1+"</b>")+"&nbsp;";
         
        var str;
     	if((hh*100+mm)>(hh1*100+mm1)) {
		hh1=hh-hh1; mm1=mm-mm1; str='minor';
        }else{
		hh1=hh1-hh; mm1=mm1-mm; str='maggior';
        }
        if(mm1<0) { mm1+=60; hh1--; }
	    if(hh1<=1)
            outmsg+=" - ("+(hh1+':'+(mm1<10?'0':'')+mm1+' di '+str+' presenza)');
	    outmsg+='</li>';
     }
     document.getElementById("navt").innerHTML = outmsg+'</ul>';
}
// --></script>
</body></html>
